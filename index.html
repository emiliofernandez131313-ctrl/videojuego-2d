<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÉ Caza los Monstruos - Halloween Edition</title>

  <!-- √çcono del sitio -->
  <link rel="icon" href="assets/icono.jpg" type="image/jpeg">

  <!-- Bootstrap y CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-orange: #FF6B00;
      --dark-orange: #E55A00;
      --halloween-purple: #8B2AAA;
      --dark-bg: #1A1A1A;
      --glow-effect: 0 0 15px rgba(255, 107, 0, 0.7);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d1a36 100%);
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      cursor: url('assets/cursor.png'), auto;
    }

    /* Efectos de part√≠culas de fondo */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    .particle {
      position: absolute;
      background: var(--primary-orange);
      border-radius: 50%;
      opacity: 0.3;
      animation: float 15s infinite linear;
    }

    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(-100vh) rotate(360deg); }
    }

    header {
      background: linear-gradient(to right, var(--dark-bg), var(--halloween-purple), var(--dark-bg));
      border-bottom: 3px solid var(--primary-orange);
      box-shadow: var(--glow-effect);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--primary-orange), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .title-container {
      background: rgba(0, 0, 0, 0.7);
      border-radius: 15px;
      padding: 10px 20px;
      display: inline-block;
      border: 2px solid var(--primary-orange);
      box-shadow: var(--glow-effect);
    }

    h1 {
      color: white;
      text-shadow: 0 0 10px var(--primary-orange), 0 0 20px var(--primary-orange);
      font-weight: bold;
      letter-spacing: 1px;
    }

    .logo {
      filter: drop-shadow(0 0 10px var(--primary-orange));
      transition: transform 0.3s ease;
    }

    .logo:hover {
      transform: scale(1.1) rotate(10deg);
    }

    #canvasJuego {
      background: url('assets/fondo_halloween.jpg') no-repeat center center;
      background-size: cover;
      border: 3px solid var(--primary-orange);
      border-radius: 15px;
      box-shadow: var(--glow-effect), 0 0 30px rgba(139, 42, 170, 0.5);
      cursor: url('assets/cursor.png'), crosshair;
      transition: all 0.3s ease;
    }

    #canvasJuego:hover {
      box-shadow: 0 0 40px var(--primary-orange), 0 0 60px rgba(139, 42, 170, 0.7);
    }

    .instrucciones {
      border: 2px solid var(--primary-orange);
      box-shadow: var(--glow-effect);
      background: linear-gradient(145deg, rgba(26,26,26,0.9) 0%, rgba(43,21,53,0.9) 100%);
      padding: 20px;
      border-radius: 15px;
      backdrop-filter: blur(5px);
    }

    .instrucciones h4 {
      color: var(--primary-orange);
      border-bottom: 2px solid var(--primary-orange);
      padding-bottom: 10px;
      margin-bottom: 15px;
    }

    .puntuacion-container {
      background: linear-gradient(135deg, var(--dark-bg) 0%, var(--halloween-purple) 100%);
      border: 2px solid var(--primary-orange);
      border-radius: 15px;
      padding: 15px 30px;
      display: inline-block;
      margin-top: 20px;
      box-shadow: var(--glow-effect);
    }

    #puntos {
      color: var(--primary-orange);
      font-weight: bold;
      font-size: 1.8rem;
      text-shadow: 0 0 10px rgba(255, 107, 0, 0.7);
    }

    .controles-audio {
      background: linear-gradient(135deg, var(--dark-bg) 0%, rgba(139, 42, 170, 0.8) 100%);
      border: 2px solid var(--primary-orange);
      border-radius: 15px;
      padding: 15px;
      margin-top: 20px;
      box-shadow: var(--glow-effect);
    }

    .form-range::-webkit-slider-thumb {
      background: var(--primary-orange);
      box-shadow: 0 0 10px var(--primary-orange);
    }

    .form-range::-moz-range-thumb {
      background: var(--primary-orange);
      box-shadow: 0 0 10px var(--primary-orange);
    }

    footer {
      background: linear-gradient(to right, var(--dark-bg), var(--halloween-purple), var(--dark-bg));
      border-top: 3px solid var(--primary-orange);
      margin-top: auto;
      box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.5);
    }

    .creadores {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(26,26,26,0.95) 0%, rgba(43,21,53,0.95) 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .mensaje-inicio {
      background: linear-gradient(145deg, var(--dark-bg) 0%, var(--halloween-purple) 100%);
      border: 3px solid var(--primary-orange);
      border-radius: 20px;
      padding: 40px;
      text-align: center;
      max-width: 600px;
      box-shadow: 0 0 50px var(--primary-orange);
      animation: pulse 2s infinite;
    }

    .mensaje-game-over {
      background: linear-gradient(145deg, #8B0000 0%, #4B0082 100%);
      border: 3px solid #FF0000;
      border-radius: 20px;
      padding: 40px;
      text-align: center;
      max-width: 600px;
      box-shadow: 0 0 50px #FF0000;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 30px var(--primary-orange); }
      50% { box-shadow: 0 0 60px var(--primary-orange); }
      100% { box-shadow: 0 0 30px var(--primary-orange); }
    }

    .btn-halloween {
      background: linear-gradient(135deg, var(--primary-orange) 0%, var(--dark-orange) 100%);
      border: none;
      color: white;
      font-weight: bold;
      padding: 12px 30px;
      border-radius: 50px;
      margin-top: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }

    .btn-halloween:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, var(--dark-orange) 0%, var(--primary-orange) 100%);
    }

    .btn-start {
      background: linear-gradient(135deg, #00FF00 0%, #008800 100%);
      border: none;
      color: white;
      font-weight: bold;
      padding: 15px 40px;
      border-radius: 50px;
      margin-top: 20px;
      box-shadow: 0 5px 15px rgba(0, 255, 0, 0.3);
      transition: all 0.3s ease;
      font-size: 1.2rem;
    }

    .btn-start:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 255, 0, 0.5);
      background: linear-gradient(135deg, #008800 0%, #00FF00 100%);
    }

    .stats-container {
      display: flex;
      justify-content: space-around;
      margin-top: 15px;
    }

    .stat {
      text-align: center;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary-orange);
    }

    .cursor-respaldo {
      cursor: crosshair;
    }

    .game-stats {
      background: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
    }

    .game-stats p {
      margin: 5px 0;
      font-size: 1.1rem;
    }

    .dificultad-info {
      background: rgba(255, 0, 0, 0.2);
      border: 1px solid #FF0000;
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      #canvasJuego {
        width: 100% !important;
        height: 400px !important;
      }
      
      .mensaje-inicio {
        margin: 20px;
        padding: 30px 20px;
      }
    }
  </style>
</head>

<body class="cursor-respaldo">
  <!-- Part√≠culas de fondo -->
  <div class="particles" id="particles"></div>

  <!-- Overlay de inicio -->
  <div id="overlayInicio" class="overlay">
    <div class="mensaje-inicio">
      <img src="assets/logo.png" alt="Logo del juego" width="150" class="logo mb-4">
      <h2 class="mb-4">üéÉ CAZA LOS MONSTRUOS üéÉ</h2>
      <p class="fs-5 mb-4">¬°Una aventura de Halloween!</p>
      <div class="mb-4">
        <h4 class="text-warning">INSTRUCCIONES üïπÔ∏è</h4>
        <p>Haz clic en los monstruos para eliminarlos y ganar puntos.</p>
        <p>¬°Cuidado con las <span class="text-danger">plumas mortales</span>! Si tocas alguna, pierdes.</p>
        <p>Cada monstruo eliminado te da <span class="text-warning">1 punto</span>.</p>
        <div class="dificultad-info mt-3">
          <p class="text-danger mb-0"><i class="fas fa-exclamation-triangle me-2"></i>¬°ADVERTENCIA! Aparecer√°n m√°s plumas conforme avances</p>
        </div>
      </div>
      <button class="btn-start">
        <i class="fas fa-play me-2"></i>START GAME
      </button>
      <div class="stats-container mt-4">
        <div class="stat">
          <div class="stat-value" id="statMonsters">12</div>
          <div class="stat-label">Monstruos</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="statPlumas">3-6</div>
          <div class="stat-label">Plumas</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="statSpeed">Alta</div>
          <div class="stat-label">Velocidad</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay de Game Over -->
  <div id="overlayGameOver" class="overlay" style="display: none;">
    <div class="mensaje-game-over">
      <h2 class="mb-4">üíÄ GAME OVER üíÄ</h2>
      <div class="game-stats">
        <p><i class="fas fa-star me-2"></i>Puntuaci√≥n Final: <span id="puntuacionFinal">0</span></p>
        <p><i class="fas fa-clock me-2"></i>Tiempo de Juego: <span id="tiempoJuego">0</span> segundos</p>
        <p><i class="fas fa-skull me-2"></i>Monstruos Eliminados: <span id="monstruosEliminados">0</span></p>
        <p><i class="fas fa-feather me-2"></i>Plumas Evitadas: <span id="plumasEvitadas">0</span></p>
      </div>
      <button class="btn-halloween btn-lg" id="btnReiniciar">
        <i class="fas fa-redo me-2"></i>Jugar de Nuevo
      </button>
    </div>
  </div>

  <!-- HEADER -->
  <header class="text-center p-4">
    <div class="title-container">
      <h1 class="display-4"><i class="fas fa-ghost me-3"></i>Caza los Monstruos de Halloween<i class="fas fa-ghost ms-3"></i></h1>
    </div>
  </header>

  <!-- MAIN -->
  <main class="container my-5">
    <div class="row justify-content-center">
      <div class="col-lg-9">
        <canvas id="canvasJuego" width="1000" height="600"></canvas>
        <div class="d-flex justify-content-between align-items-center mt-4">
          <div class="puntuacion-container">
            <p class="fs-3 mb-0"><i class="fas fa-star me-2"></i>Puntuaci√≥n: <span id="puntos">0</span></p>
          </div>
          <div class="puntuacion-container">
            <p class="fs-3 mb-0"><i class="fas fa-clock me-2"></i>Tiempo: <span id="tiempo">0</span>s</p>
          </div>
          <div class="puntuacion-container">
            <p class="fs-3 mb-0"><i class="fas fa-feather me-2 text-danger"></i>Plumas: <span id="contadorPlumas">3</span></p>
          </div>
        </div>
        
        <!-- Controles de audio -->
        <div class="controles-audio">
          <div class="d-flex align-items-center justify-content-center mb-2">
            <span class="me-3 fs-5"><i class="fas fa-volume-mute"></i></span>
            <input type="range" id="volumen" class="form-range" min="0" max="1" step="0.1" value="0.5" style="width: 200px;">
            <span class="ms-3 fs-5"><i class="fas fa-volume-up"></i></span>
          </div>
          <p class="mt-2 mb-0 text-center"><small>Ajusta el volumen de la m√∫sica ambiental</small></p>
        </div>
      </div>
      <div class="col-lg-3 instrucciones mt-4 mt-lg-0">
        <h4><i class="fas fa-gamepad me-2"></i>Instrucciones</h4>
        <p class="mb-3">Haz clic en los <span class="text-warning">monstruos</span> para eliminarlos y ganar puntos.</p>
        <p class="mb-3">¬°Cuidado con las <span class="text-danger">plumas mortales</span>! Si tocas alguna, pierdes.</p>
        <p class="mb-3">Cada monstruo eliminado te da <strong class="text-warning">1 punto</strong>.</p>
        
        <div class="mt-4">
          <h5><i class="fas fa-tasks me-2"></i>Elementos del Juego</h5>
          <p class="mb-2"><i class="fas fa-ghost me-2 text-warning"></i>Monstruo 1 - 1 punto</p>
          <p class="mb-2"><i class="fas fa-ghost me-2 text-info"></i>Monstruo 2 - 1 punto</p>
          <p class="mb-2"><i class="fas fa-feather me-2 text-danger"></i>Pluma Mortal - Game Over</p>
        </div>
        
        <div class="mt-4 p-3 rounded" style="background: rgba(255,107,0,0.1); border: 1px solid var(--primary-orange);">
          <h6><i class="fas fa-info-circle me-2"></i>Sistema de Dificultad</h6>
          <p class="small mb-0">Cada 10 segundos aparece una nueva pluma. ¬°Cuanto m√°s tiempo juegues, m√°s peligroso ser√°!</p>
        </div>

        <div class="mt-3 p-3 rounded" style="background: rgba(255,0,0,0.1); border: 1px solid #FF0000;">
          <h6><i class="fas fa-exclamation-triangle me-2 text-danger"></i>Nivel Actual</h6>
          <p class="small mb-0" id="nivelDificultad">Plumas en pantalla: <span id="plumasActuales">3</span></p>
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="text-center p-4">
    <div class="container">
      <p class="mb-2">Desarrollado con <i class="fas fa-heart text-danger"></i> para una experiencia de Halloween espeluznante</p>
      <p class="creadores mb-0">Creado por: <strong>C√©sar Estrada Flores</strong> (No. Control: 23200832) | <strong>Emilio Sebasti√°n Fern√°ndez</strong> (No. Control: 23200835)</p>
    </div>
  </footer>

  <!-- M√öSICA DE FONDO -->
  <audio id="musica" loop>
    <source src="assets/musica.mp3" type="audio/mpeg">
    Tu navegador no soporta la reproducci√≥n de audio.
  </audio>

  <script>
    // Crear part√≠culas de fondo
    function crearParticulas() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Tama√±o aleatorio
        const size = Math.random() * 20 + 5;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        
        // Posici√≥n aleatoria
        particle.style.left = `${Math.random() * 100}vw`;
        particle.style.top = `${Math.random() * 100}vh`;
        
        // Color aleatorio (tonos naranja/morado)
        const colors = ['#FF6B00', '#E55A00', '#8B2AAA', '#FF8C42'];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        
        // Animaci√≥n con duraci√≥n aleatoria
        particle.style.animationDuration = `${Math.random() * 20 + 10}s`;
        particle.style.animationDelay = `${Math.random() * 5}s`;
        
        particlesContainer.appendChild(particle);
      }
    }

    // Inicializar part√≠culas
    crearParticulas();

    const canvas = document.getElementById("canvasJuego");
    const ctx = canvas.getContext("2d");
    const puntosTexto = document.getElementById("puntos");
    const tiempoTexto = document.getElementById("tiempo");
    const contadorPlumasTexto = document.getElementById("contadorPlumas");
    const plumasActualesTexto = document.getElementById("plumasActuales");
    const musica = document.getElementById("musica");
    const controlVolumen = document.getElementById("volumen");
    const overlayInicio = document.getElementById("overlayInicio");
    const overlayGameOver = document.getElementById("overlayGameOver");
    const btnInicio = document.querySelector('.btn-start');
    const btnReiniciar = document.getElementById('btnReiniciar');
    const puntuacionFinal = document.getElementById('puntuacionFinal');
    const tiempoJuego = document.getElementById('tiempoJuego');
    const monstruosEliminados = document.getElementById('monstruosEliminados');
    const plumasEvitadas = document.getElementById('plumasEvitadas');

    let puntos = 0;
    let tiempoTranscurrido = 0;
    let plumasEvitadasCount = 0;
    let monstruos = [];
    let plumas = [];
    let juegoIniciado = false;
    let juegoActivo = false;
    let temporizador;
    let temporizadorPlumas;
    let velocidadBase = 4;
    const imagenMonstruo = new Image();
    const imagenMonstruo2 = new Image();
    const imagenPluma = new Image();
    
    // Cargar imagen de fondo Halloween
    const fondoHalloween = new Image();
    fondoHalloween.src = "assets/fondo_halloween.jpg";
    
    // Tama√±o de elementos
    const monsterSize = 120;
    const plumaSize = 80;
    
    // Verificar si el cursor se carg√≥ correctamente
    const cursorImg = new Image();
    cursorImg.onload = function() {
      console.log("Cursor cargado correctamente");
      document.body.style.cursor = 'url("assets/cursor.png"), auto';
      canvas.style.cursor = 'url("assets/cursor.png"), crosshair';
    };
    cursorImg.onerror = function() {
      console.warn("No se pudo cargar el cursor personalizado, usar cursor por defecto");
      document.body.classList.add('cursor-respaldo');
    };
    cursorImg.src = "assets/cursor.png";

    // Im√°genes de monstruos y pluma
    imagenMonstruo.src = "assets/monstruo.png";
    imagenMonstruo2.src = "assets/monstruo2.png";
    imagenPluma.src = "assets/pluma.png";

    // Configurar volumen inicial
    musica.volume = controlVolumen.value;

    // Controlador de volumen
    controlVolumen.addEventListener("input", function() {
      musica.volume = this.value;
    });

    // Funci√≥n para iniciar el juego
    function iniciarJuego() {
      if (juegoIniciado) return;
      
      juegoIniciado = true;
      juegoActivo = true;
      overlayInicio.style.display = 'none';
      
      // Reiniciar variables del juego
      puntos = 0;
      tiempoTranscurrido = 0;
      plumasEvitadasCount = 0;
      puntosTexto.textContent = puntos;
      tiempoTexto.textContent = tiempoTranscurrido;
      contadorPlumasTexto.textContent = '3';
      plumasActualesTexto.textContent = '3';
      
      // Intentar reproducir la m√∫sica
      musica.play().then(() => {
        console.log("M√∫sica de fondo iniciada correctamente");
      }).catch(error => {
        console.error("Error al reproducir audio:", error);
      });
      
      // Inicializar monstruos y plumas
      monstruos = [];
      plumas = [];
      
      for (let i = 0; i < 8; i++) {
        monstruos.push(crearMonstruo());
      }
      
      for (let i = 0; i < 4; i++) {
        monstruos.push(crearMonstruo2());
      }
      
      // Agregar plumas mortales iniciales (3 plumas)
      for (let i = 0; i < 3; i++) {
        plumas.push(crearPluma());
      }
      
      // Iniciar temporizador principal
      temporizador = setInterval(() => {
        if (juegoActivo) {
          tiempoTranscurrido++;
          tiempoTexto.textContent = tiempoTranscurrido;
          
          // Aumentar dificultad cada 10 segundos
          if (tiempoTranscurrido % 10 === 0 && plumas.length < 8) {
            agregarPluma();
          }
        }
      }, 1000);
      
      // Iniciar temporizador para mover plumas m√°s r√°pido
      temporizadorPlumas = setInterval(() => {
        if (juegoActivo) {
          // Aumentar velocidad de plumas gradualmente
          plumas.forEach(p => {
            p.dx *= 1.05;
            p.dy *= 1.05;
          });
        }
      }, 5000);
      
      // Iniciar el bucle del juego
      loop();
    }

    // Funci√≥n para agregar una nueva pluma
    function agregarPluma() {
      if (plumas.length < 8) {
        plumas.push(crearPluma());
        contadorPlumasTexto.textContent = plumas.length;
        plumasActualesTexto.textContent = plumas.length;
        
        // Efecto visual de advertencia
        ctx.fillStyle = 'rgba(255, 0, 0, 0.3)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
    }

    // Funci√≥n para terminar el juego
    function gameOver() {
      juegoActivo = false;
      clearInterval(temporizador);
      clearInterval(temporizadorPlumas);
      
      // Mostrar estad√≠sticas finales
      puntuacionFinal.textContent = puntos;
      tiempoJuego.textContent = tiempoTranscurrido;
      monstruosEliminados.textContent = puntos;
      plumasEvitadas.textContent = plumasEvitadasCount;
      
      overlayGameOver.style.display = 'flex';
    }

    // Reiniciar juego
    btnReiniciar.addEventListener('click', function() {
      overlayGameOver.style.display = 'none';
      juegoIniciado = false;
      iniciarJuego();
    });

    // Iniciar juego con el bot√≥n START
    btnInicio.addEventListener('click', iniciarJuego);

    // Crear monstruo tipo 1
    function crearMonstruo() {
      const velocidad = velocidadBase + (puntos * 0.1);
      
      return {
        x: Math.random() * (canvas.width - monsterSize),
        y: Math.random() * (canvas.height - monsterSize),
        dx: (Math.random() - 0.5) * velocidad,
        dy: (Math.random() - 0.5) * velocidad,
        visible: true,
        size: monsterSize,
        tipo: 1
      };
    }

    // Crear monstruo tipo 2
    function crearMonstruo2() {
      const velocidad = velocidadBase + (puntos * 0.1) + 1;
      
      return {
        x: Math.random() * (canvas.width - monsterSize),
        y: Math.random() * (canvas.height - monsterSize),
        dx: (Math.random() - 0.5) * velocidad,
        dy: (Math.random() - 0.5) * velocidad,
        visible: true,
        size: monsterSize,
        tipo: 2
      };
    }

    // Crear pluma mortal
    function crearPluma() {
      return {
        x: Math.random() * (canvas.width - plumaSize),
        y: Math.random() * (canvas.height - plumaSize),
        dx: (Math.random() - 0.5) * (3 + tiempoTranscurrido * 0.1),
        dy: (Math.random() - 0.5) * (3 + tiempoTranscurrido * 0.1),
        visible: true,
        size: plumaSize
      };
    }

    function moverElementos() {
      // Limpiar canvas con fondo semitransparente para efecto de rastro
      ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Dibujar el fondo Halloween
      if (fondoHalloween.complete) {
        ctx.drawImage(fondoHalloween, 0, 0, canvas.width, canvas.height);
      }

      // Dibujar y mover monstruos
      monstruos.forEach(m => {
        if (!m.visible) return;

        m.x += m.dx;
        m.y += m.dy;

        // Rebotan en los bordes
        if (m.x < 0 || m.x > canvas.width - m.size) m.dx *= -1;
        if (m.y < 0 || m.y > canvas.height - m.size) m.dy *= -1;

        // Dibujar monstruo seg√∫n su tipo
        let imagen;
        let colorBrillo;
        
        if (m.tipo === 1) {
          imagen = imagenMonstruo;
          colorBrillo = 'orange';
        } else {
          imagen = imagenMonstruo2;
          colorBrillo = 'cyan';
        }

        if (imagen.complete && imagen.naturalHeight !== 0) {
          ctx.shadowColor = colorBrillo;
          ctx.shadowBlur = 15;
          ctx.drawImage(imagen, m.x, m.y, m.size, m.size);
          ctx.shadowBlur = 0;
        } else {
          ctx.fillStyle = m.tipo === 1 ? 'purple' : 'blue';
          ctx.fillRect(m.x, m.y, m.size, m.size);
        }
      });

      // Dibujar y mover plumas
      plumas.forEach(p => {
        if (!p.visible) return;

        p.x += p.dx;
        p.y += p.dy;

        // Rebotan en los bordes
        if (p.x < 0 || p.x > canvas.width - p.size) p.dx *= -1;
        if (p.y < 0 || p.y > canvas.height - p.size) p.dy *= -1;

        // Dibujar pluma
        if (imagenPluma.complete && imagenPluma.naturalHeight !== 0) {
          ctx.shadowColor = 'red';
          ctx.shadowBlur = 20;
          ctx.drawImage(imagenPluma, p.x, p.y, p.size, p.size);
          ctx.shadowBlur = 0;
        } else {
          ctx.fillStyle = 'red';
          ctx.fillRect(p.x, p.y, p.size, p.size);
        }
      });
    }

    // Detectar clic sobre elementos
    canvas.addEventListener("click", e => {
      if (!juegoActivo) return;
      
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      // Verificar clic en monstruos
      let monstruoEliminado = false;
      monstruos.forEach(m => {
        if (m.visible && x > m.x && x < m.x + m.size && y > m.y && y < m.y + m.size) {
          m.visible = false;
          puntos++;
          puntosTexto.textContent = puntos;
          monstruoEliminado = true;
          
          // Efecto visual al eliminar monstruo
          ctx.fillStyle = 'rgba(255, 215, 0, 0.5)';
          ctx.beginPath();
          ctx.arc(m.x + m.size/2, m.y + m.size/2, m.size/2, 0, Math.PI * 2);
          ctx.fill();
          
          setTimeout(() => {
            if (juegoActivo) {
              if (m.tipo === 1) {
                Object.assign(m, crearMonstruo());
              } else {
                Object.assign(m, crearMonstruo2());
              }
            }
          }, 1000);
        }
      });

      // Verificar clic en pluma (GAME OVER)
      plumas.forEach(p => {
        if (p.visible && x > p.x && x < p.x + p.size && y > p.y && y < p.y + p.size) {
          gameOver();
        }
      });

      // Contar plumas evitadas (solo si se hizo clic y no fue en una pluma)
      if (monstruoEliminado) {
        plumasEvitadasCount += plumas.length;
      }
    });

    function loop() {
      if (juegoActivo) {
        moverElementos();
        requestAnimationFrame(loop);
      }
    }
  </script>
</body>
</html>